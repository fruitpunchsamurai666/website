<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="DENG Zhan">

<title>My VAA Journey - Take-home_Ex3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="../site_libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../site_libs/datatables-binding-0.27/datatables.js"></script>
<link href="../site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="../site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="../site_libs/vis-9.1.0/vis-network.min.js"></script>
<script src="../site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">My VAA Journey</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../In-class_EX/In-class_Ex03.html">
 <span class="dropdown-text">In-class_Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_EX/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class_Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_EX/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-class_Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_EX/In-class_Ex06/In-class_Ex06.html">
 <span class="dropdown-text">In-class_Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_EX/In-class_Ex07/In-class_Ex07.html">
 <span class="dropdown-text">In-class_Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_EX/In-class_Ex08/In-class_Ex08.html">
 <span class="dropdown-text">In-class_Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_EX/In-class_Ex09/In-class_Ex09.html">
 <span class="dropdown-text">In-class_Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_EX/In-class_Ex10/In-class_Ex10.html">
 <span class="dropdown-text">In-class_Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../Take-home_EX/Take-home_Ex1.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Take-home_EX/Take-home_EX02/Take-home_Ex2.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Take-home_EX/Take-home_Ex3.html">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#take-home-exercise-3" id="toc-take-home-exercise-3" class="nav-link active" data-scroll-target="#take-home-exercise-3">Take home exercise 3</a>
  <ul class="collapse">
  <li><a href="#the-task" id="toc-the-task" class="nav-link" data-scroll-target="#the-task">The task</a></li>
  <li><a href="#data-pre-processing" id="toc-data-pre-processing" class="nav-link" data-scroll-target="#data-pre-processing">Data Pre-processing</a></li>
  <li><a href="#nodes-grouping-by-using-topic-modelling" id="toc-nodes-grouping-by-using-topic-modelling" class="nav-link" data-scroll-target="#nodes-grouping-by-using-topic-modelling">Nodes Grouping by Using Topic Modelling</a></li>
  <li><a href="#network-visualisation-and-analysis" id="toc-network-visualisation-and-analysis" class="nav-link" data-scroll-target="#network-visualisation-and-analysis">Network Visualisation and Analysis</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home_Ex3</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>DENG Zhan </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="take-home-exercise-3" class="level1">
<h1>Take home exercise 3</h1>
<section id="the-task" class="level2">
<h2 class="anchored" data-anchor-id="the-task">The task</h2>
<p>With reference to Mini-Challenge 3 of VAST Challenge 2023 and by using appropriate static and interactive statistical graphics methods, you are required to help FishEye identify companies that may be engaged in illegal fishing. (website: https://vast-challenge.github.io/2023/MC3.html)</p>
<p>Question chosen: Develop a visual analytics process to find similar businesses and group them. This analysis should focus on a business’s most important features and present those features clearly to the user.</p>
</section>
<section id="data-pre-processing" class="level2">
<h2 class="anchored" data-anchor-id="data-pre-processing">Data Pre-processing</h2>
<ol type="1">
<li>load packages and dataset</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(jsonlite, tidygraph, ggraph, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               visNetwork, graphlayouts, ggforce, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               skimr, tidytext,tidyverse,topicmodels,tm,plotly,ggstatsplot,rstantools,PMCMRplus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mc3_data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>extract edges from JSON</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mc3_edges <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mc3_data<span class="sc">$</span>links) <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="fu">as.character</span>(source),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">target =</span> <span class="fu">as.character</span>(target),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as.character</span>(type)) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, type) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>extract nodes from JSON</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mc3_nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mc3_data<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">as.character</span>(country),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">id =</span> <span class="fu">as.character</span>(id),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">product_services =</span> <span class="fu">as.character</span>(product_services),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">revenue_omu =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(revenue_omu)),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as.character</span>(type)) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, country, type, revenue_omu, product_services)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li>Display the proportion of mc3_edges types (Beneficial owner and Company contacts)</li>
</ol>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the count of X by Category</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>edge_type_summary <span class="ot">&lt;-</span> mc3_edges <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>())<span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create pie chart using ggplot</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>chart <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(edge_type_summary, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> Count, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"lightblue"</span>, <span class="st">"lightpink"</span>)) <span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(Count<span class="sc">/</span><span class="fu">sum</span>(Count)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>), <span class="st">"%"</span>)), <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>chart</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex3_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="5" type="1">
<li>Recoding “character(0)” to “others” in product_services field for all nodes.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#recode nodes with product_services is character(0)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>mc3_nodes<span class="sc">$</span>product_services <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mc3_nodes<span class="sc">$</span>product_services <span class="sc">==</span> <span class="st">"character(0)"</span>, <span class="st">"others"</span>, mc3_nodes<span class="sc">$</span>product_services)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="6" type="1">
<li>Display the proportion of mc3_nodes types (Beneficial owner/Company contacts/Company)</li>
</ol>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the count of X by Category</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>node_type_summary <span class="ot">&lt;-</span> mc3_nodes <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create pie chart using ggplot</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>chart2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(node_type_summary, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> Count, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"lightblue"</span>, <span class="st">"lightpink"</span>,<span class="st">"lightgrey"</span>)) <span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(Count<span class="sc">/</span><span class="fu">sum</span>(Count)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>), <span class="st">"%"</span>)), <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>chart2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex3_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="nodes-grouping-by-using-topic-modelling" class="level2">
<h2 class="anchored" data-anchor-id="nodes-grouping-by-using-topic-modelling">Nodes Grouping by Using Topic Modelling</h2>
<ol type="1">
<li>Perform basic text analysis preprocessing (change to lowercase, remove punctuation, remove numbers, remove stopwords) and create a document-term matrix after that. Nodes with “others” and “Unknown” product services are excluded from this text analysis section.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a corpus from product_services</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>mc3_nodes <span class="ot">&lt;-</span> mc3_nodes <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>product_services<span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"others"</span>, <span class="st">"Unknown"</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">length</span>(mc3_nodes<span class="sc">$</span>id),<span class="st">" nodes left in the dataset."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "4018  nodes left in the dataset."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create a corpus object</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">Corpus</span>(<span class="fu">VectorSource</span>(mc3_nodes<span class="sc">$</span>product_services))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform basic preprocessing (lowercase, remove punctuation, remove numbers, remove stopwords)</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, removeNumbers)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(tolower))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, removePunctuation)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, removeNumbers)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, removeWords, <span class="fu">stopwords</span>(<span class="st">"english"</span>))</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a document-term matrix</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>dtm <span class="ot">&lt;-</span> <span class="fu">DocumentTermMatrix</span>(corpus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>LDA topic modelling (limited to 5 topics)</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the LDA model</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>lda_model <span class="ot">&lt;-</span> <span class="fu">LDA</span>(dtm, <span class="at">control=</span><span class="fu">list</span>(<span class="at">seed=</span><span class="dv">1</span>), <span class="at">k =</span> <span class="dv">5</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Display the top 7 terms for each of the topic</li>
</ol>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve the top 7 terms for each topic</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>topics <span class="ot">&lt;-</span> <span class="fu">terms</span>(lda_model, <span class="dv">7</span>)  </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the topics and associated terms</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Topic"</span>, i, <span class="st">":"</span>, <span class="fu">paste</span>(topics[,i], <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Topic 1 : services, freight, transportation, logistics, source, freelance, researcher 
Topic 2 : fish, salmon, products, frozen, tuna, shrimp, squid 
Topic 3 : products, shoes, footwear, chemicals, oil, apparel, well 
Topic 4 : products, equipment, materials, systems, parts, machines, steel 
Topic 5 : products, seafood, fish, food, frozen, fresh, related </code></pre>
</div>
</div>
<p>From the top terms of each topic, we can easily summarize the respective business feature for the groups as below:</p>
<p>Topic 1: transportation and logistics</p>
<p>Topic 2: fish and other seafood</p>
<p>Topic 3: chemicals and accessories</p>
<p>Topic 4: equipment</p>
<p>Topic 5: food products</p>
<ol start="4" type="1">
<li>Map the topics back to the nodes table as their groups.</li>
</ol>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#extract the probability for each topic</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>doc_topic_probs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">topics</span>(lda_model))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Map topics back to documents</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>mapped_nodes <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mc3_nodes, doc_topic_probs) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="at">.col=</span><span class="dv">6</span>, <span class="sc">~</span><span class="st">"topic"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">topic =</span> <span class="fu">as.character</span>(topic))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#recode topic names</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>mapped_nodes<span class="sc">$</span>topic_name <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  mapped_nodes<span class="sc">$</span>topic <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"transportation and logistics"</span>,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  mapped_nodes<span class="sc">$</span>topic <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"fish and other seafood"</span>,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  mapped_nodes<span class="sc">$</span>topic <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"chemicals and accessories"</span>,</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  mapped_nodes<span class="sc">$</span>topic <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"equipment"</span>,</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"food products"</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="5" type="1">
<li>Visualize the business group (topics) distribution for each node type.</li>
</ol>
<p>The bar chart below shows the topic distribution for each type of nodes.</p>
<ul>
<li><p>For beneficial owner, none of them are grouped under “chemicals and accessories”. Majority of them are doing fish and seafood related business.</p></li>
<li><p>Companies that are grouped under equipment and food products are more than the other three businesses.</p></li>
<li><p>For company contacts, there is only one record left. As company contacts should represent his company, its business feature is not meaningful in this context.</p></li>
</ul>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the count of nodes by type</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>topic_dist <span class="ot">&lt;-</span> mapped_nodes <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type, topic_name) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar chart</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(topic_dist, <span class="fu">aes</span>(<span class="at">x =</span> topic_name, <span class="at">y =</span> Count, <span class="at">fill=</span>type)) <span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> type, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">60</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2bdce12ef222f88e631f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-2bdce12ef222f88e631f">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9],"base":[0,0,0,0],"x":[2,3,4,5],"y":[2,13,6,2],"text":["topic_name: equipment<br />Count:    2<br />type: Beneficial Owner","topic_name: fish and other seafood<br />Count:   13<br />type: Beneficial Owner","topic_name: food products<br />Count:    6<br />type: Beneficial Owner","topic_name: transportation and logistics<br />Count:    2<br />type: Beneficial Owner"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Beneficial Owner","legendgroup":"Beneficial Owner","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9],"base":[0,0,0,0,0],"x":[1,2,3,4,5],"y":[515,1076,463,1234,706],"text":["topic_name: chemicals and accessories<br />Count:  515<br />type: Company","topic_name: equipment<br />Count: 1076<br />type: Company","topic_name: fish and other seafood<br />Count:  463<br />type: Company","topic_name: food products<br />Count: 1234<br />type: Company","topic_name: transportation and logistics<br />Count:  706<br />type: Company"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Company","legendgroup":"Company","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":0.9,"base":0,"x":[4],"y":[1],"text":"topic_name: food products<br />Count:    1<br />type: Company Contacts","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Company Contacts","legendgroup":"Company Contacts","showlegend":true,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":37.9178082191781,"r":7.30593607305936,"b":39.1893014196849,"l":37.2602739726027},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,0.315839411729823],"automargin":true,"type":"linear","autorange":false,"range":[0.4,5.6],"tickmode":"array","ticktext":["chemicals and accessories","equipment","fish and other seafood","food products","transportation and logistics"],"tickvals":[1,2,3,4,5],"categoryorder":"array","categoryarray":["chemicals and accessories","equipment","fish and other seafood","food products","transportation and logistics"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-60,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.65,13.65],"tickmode":"array","ticktext":["0","5","10"],"tickvals":[0,5,10],"categoryorder":"array","categoryarray":["0","5","10"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"annotations":[{"text":"Count","x":0,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis","xshift":-21.9178082191781},{"text":"Beneficial Owner","x":0.157919705864911,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"Company","x":0.5,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"Company Contacts","x":0.842080294135089,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.315839411729823,"y0":0,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.315839411729823,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.350827254936844,"x1":0.649172745063156,"y0":0,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.350827254936844,"x1":0.649172745063156,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.684160588270177,"x1":1,"y0":0,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.684160588270177,"x1":1,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"}],"xaxis2":{"type":"linear","autorange":false,"range":[0.4,5.6],"tickmode":"array","ticktext":["chemicals and accessories","equipment","fish and other seafood","food products","transportation and logistics"],"tickvals":[1,2,3,4,5],"categoryorder":"array","categoryarray":["chemicals and accessories","equipment","fish and other seafood","food products","transportation and logistics"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-60,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.350827254936844,0.649172745063156],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y2","title":"","hoverformat":".2f"},"yaxis2":{"type":"linear","autorange":false,"range":[-61.7,1295.7],"tickmode":"array","ticktext":["0","400","800","1200"],"tickvals":[0,400,800,1200],"categoryorder":"array","categoryarray":["0","400","800","1200"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x2","title":"","hoverformat":".2f"},"xaxis3":{"type":"linear","autorange":false,"range":[0.4,5.6],"tickmode":"array","ticktext":["chemicals and accessories","equipment","fish and other seafood","food products","transportation and logistics"],"tickvals":[1,2,3,4,5],"categoryorder":"array","categoryarray":["chemicals and accessories","equipment","fish and other seafood","food products","transportation and logistics"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-60,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.684160588270177,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y3","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[-0.05,1.05],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x3","title":"","hoverformat":".2f"},"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"type","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"2e88608c305a":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"2e88608c305a","visdat":{"2e88608c305a":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ol start="6" type="1">
<li>Explore the average revenue for each business group.</li>
</ol>
<p>Equipment business group has the highest mean revenue, followed by fish and other seafood products.</p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mapped_nodes,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> topic_name,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> revenue_omu,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Business Group"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Revenue"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"np"</span>, <span class="co">#conduct non-parametric test</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean.ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">package =</span> <span class="st">"ggsci"</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> <span class="st">"default_jco"</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex3_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="network-visualisation-and-analysis" class="level2">
<h2 class="anchored" data-anchor-id="network-visualisation-and-analysis">Network Visualisation and Analysis</h2>
<ol type="1">
<li>For a quick overview, build the network model with tidygraph.</li>
</ol>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create an updated unique node list from the edge list</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> mc3_edges <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> mc3_edges <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>mc3_nodes1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">unmatched =</span> <span class="st">"drop"</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">#build graph object and calculate centrality measures</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>mc3_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> mc3_nodes1,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">edges =</span> mc3_edges,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">directed =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">betweenness_centrality =</span> <span class="fu">centrality_betweenness</span>(),</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">closeness_centrality =</span> <span class="fu">centrality_closeness</span>())</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the network only for nodes with betweenness &gt;=100000</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>mc3_graph <span class="sc">%&gt;%</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(betweenness_centrality <span class="sc">&gt;=</span> <span class="dv">100000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> betweenness_centrality,</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex3_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="2" type="1">
<li>The plot is very dense, thus we want to zoom in to a smaller group for further analysis.</li>
</ol>
<p>A person who owns many companies are more suspicious than others. The next step is to detect such anomalies by focusing on the beneficial owners who have &gt;= 5 companies.</p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#filter out beneficial owner only, and summarize their number of company ownership</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>owner_freq <span class="ot">&lt;-</span> mc3_edges <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Beneficial Owner"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">companies_owned=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(companies_owned)) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(companies_owned <span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">#bar plot for company ownership count </span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>owner_freq_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> owner_freq,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> companies_owned)) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()<span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"num of companies ownered"</span>,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"company ownership distribution"</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(owner_freq_gg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-1275f225ecd137c8cdb1" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-1275f225ecd137c8cdb1">{"x":{"data":[{"orientation":"h","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999],"base":[0,0,0,0,0,0,0,0],"x":[901,170,42,16,3,3,1,2],"y":[2,3,4,5,6,7,8,9],"text":["count: 901<br />companies_owned: 2","count: 170<br />companies_owned: 3","count:  42<br />companies_owned: 4","count:  16<br />companies_owned: 5","count:   3<br />companies_owned: 6","count:   3<br />companies_owned: 7","count:   1<br />companies_owned: 8","count:   2<br />companies_owned: 9"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"company ownership distribution","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-45.05,946.05],"tickmode":"array","ticktext":["0","250","500","750"],"tickvals":[0,250,500,750],"categoryorder":"array","categoryarray":["0","250","500","750"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Frequency","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1.155,9.845],"tickmode":"array","ticktext":["2.5","5.0","7.5"],"tickvals":[2.5,5,7.5],"categoryorder":"array","categoryarray":["2.5","5.0","7.5"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"num of companies ownered","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"2e88567d6e2e":{"x":{},"type":"bar"}},"cur_data":"2e88567d6e2e","visdat":{"2e88567d6e2e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Edges for targets with exactly one ownership have already been eliminated (they are less suspicious too). Based on the distribution plot, I will set the threshold at 5 (inclusive), in order to focus on the tail for further analysis.</p>
<p>Suspicious target person who owns more than or equal to 5 companies:</p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>owner_freq_reduced  <span class="ot">&lt;-</span> owner_freq <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(companies_owned <span class="sc">&gt;=</span> <span class="dv">5</span>) </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(owner_freq_reduced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-8afa6f077ee37a3e7cb9" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8afa6f077ee37a3e7cb9">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25"],["John Smith","Michael Johnson","Jennifer Smith","James Smith","John Williams","Michael Williams","David Jones","Lisa Johnson","Richard Smith","Amy Williams","Ashley Harris","Brian Smith","Christopher Jones","David Johnson","David Thomas","Jennifer Taylor","Jessica Brown","Joshua Smith","Mark Miller","Mary Williams","Michael Bell","Michael Carter","Michael Miller","Michael Smith","Robert Johnson"],[9,9,8,7,7,7,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>target<\/th>\n      <th>companies_owned<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ol start="3" type="1">
<li>Network visualization of beneficial owners with more than 5 companies. Node size represents betweenness centrality, color represents the business group (grey means its product_services is not available).</li>
</ol>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set random seed</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">#filter out edges with the suspicious beneficial owner only</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>sub_edge <span class="ot">&lt;-</span> mc3_edges <span class="sc">%&gt;%</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(target <span class="sc">%in%</span> <span class="fu">c</span>(owner_freq_reduced<span class="sc">$</span>target)) </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">#create an updated unique node list from the edge list</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> sub_edge <span class="sc">%&gt;%</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> sub_edge <span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>sub_node <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mapped_nodes,<span class="at">by =</span> <span class="st">"id"</span>,<span class="at">unmatched =</span> <span class="st">"drop"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id,<span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co">#build graph object and calculate centrality measures</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>mc3_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> sub_node,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>                       <span class="at">edges =</span> sub_edge,</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">directed =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">betweenness_centrality =</span> <span class="fu">centrality_betweenness</span>())</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the network </span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>mc3_graph <span class="sc">%&gt;%</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> betweenness_centrality,</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> topic_name,</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex3_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="4" type="1">
<li>Now let us use VisNetwork to make it an interactive plot (company is marked in star).</li>
</ol>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot visnetwork graph - first need to change column name</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a> sub_edge <span class="ot">&lt;-</span> sub_edge <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">from =</span> source) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">to =</span> target)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">#set random seed</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">#store betweenness values</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>betweenness_values <span class="ot">&lt;-</span> mc3_graph <span class="sc">%&gt;%</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(betweenness_centrality)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co">#store attributes with respective column name that is readable by visnetwork</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>sub_node<span class="sc">$</span>group <span class="ot">&lt;-</span> sub_node<span class="sc">$</span>topic_name</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>sub_node<span class="sc">$</span>value <span class="ot">&lt;-</span> betweenness_values</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>sub_node<span class="sc">$</span>shape <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(sub_node<span class="sc">$</span>type<span class="sc">==</span><span class="st">"Company"</span>,<span class="st">"star"</span>,<span class="st">"dot"</span>)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>sub_edge<span class="sc">$</span>value <span class="ot">&lt;-</span> sub_edge<span class="sc">$</span>weights</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(sub_node,sub_edge) <span class="sc">%&gt;%</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,<span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>,<span class="at">selectedBy =</span> <span class="st">"topic_name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visGroups</span>(<span class="at">groupname =</span> <span class="st">"food products"</span>, <span class="at">color =</span> <span class="st">"orange"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visGroups</span>(<span class="at">groupname =</span> <span class="st">"fish and other seafood"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visGroups</span>(<span class="at">groupname =</span> <span class="st">"transportation and logistics"</span>, <span class="at">color =</span>  <span class="st">"lightgreen"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visGroups</span>(<span class="at">groupname =</span> <span class="st">"equipment"</span>, <span class="at">color =</span><span class="st">"purple"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visGroups</span>(<span class="at">groupname =</span> <span class="st">"chemicals and accessories"</span>, <span class="at">color =</span> <span class="st">"yellow"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>(<span class="at">position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-1b157836fbedf5a2b62c" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-1b157836fbedf5a2b62c">{"x":{"nodes":{"id":["Acevedo, Dickson and Gonzalez","Adams Group","Adriatic Catch S.A. de C.V.","Alexander PLC","Alvarez Ltd","Alvarez, Young and Ramos","Andrews, Finley and Mcdaniel","Aqua Aura SE Marine life","Aqua Gourmet Incorporated Creek","Arnold, Wise and Fuentes","Ashley, Christensen and Bender","Bahía del Sol Corporation","Baker and Sons","Bauer-Taylor","Beach Bums Corporation Transit","BlueTide GmbH & Co. KG","Brewer Inc","Brown-Evans","Brown-Frank","Bu yu wang AG","Byrd-Flores","Caracola del Este Sagl Solutions","Carter LLC","Chase, Hernandez and Wade","Chavez PLC","Chen, Jones and Davis","Clayton Ltd","Coleman, Harris and Mitchell","Congo Rapids   AG Sea spray","Cortez Group","Costa de Coral Kga","Davis, Webb and Martin","Dean-Fisher","Dnipro  Saltwater N.V. Services","Faroe Islands  Company World","Faroe Islands  Ltd Express","FinAddict GmbH & Co. KG","Finests  S.A. de C.V.","Fisher Inc","Fowler-Davis","Garcia, Ferguson and Miller","Garcia, Smith and Scott","Gardner, Jones and Armstrong","Graham Inc","Gujarat ers Limited Liability Company","Gutierrez Inc","Guzman-Chang","Gvardeysk Cargo  SRL Investment","Hall-Taylor","Hamilton LLC","Hancock Inc","Haryana Sea  Mudflat Ltd Freight","Haynes and Sons","Henderson and Sons","Hernandez, Smith and Harrison","Hernandez, Stewart and Nelson","Hopkins, Cunningham and Macdonald","Icelandic Shrimp AS Brothers","Isla del Este _","Jackson-Guzman","Jacobs-Henry","Jones, Kennedy and Johnson","Kariba Dam   CJSC Marine sanctuary","Knight-Brown","Kong zhong diao yu  GmbH","Lang, Garcia and Harris","Lee and Sons","Limpopo River  Ltd. Liability Co","Lloyd-Russell","Long-Charles","Luangwa River   Limited Liability Company Holdings","Lucas-Shelton","Madhya Pradesh   Ltd. Liability Co Freight","Malawi Rift   S.A. de C.V. Express","Mar de Coral GmbH and Son's","Mar de Cristal Ltd Abalone","Mar de Cristal ОАО","Mar de Plata Sp","Mar de Sirenas Corporation Transport","Mar del Oeste -","Mcintyre-White","Meadows, Malone and Willis","Miller, Wiggins and Smith","Montes, Kidd and Hall","Moon LLC","Murphy-Russell","Nagaland Sea Catch Ltd. Liability Co Logistics","Nichols PLC","Norwegian Fjord  Corp Cruise ship","Norwegian Fjord  S.A. de C.V. Brothers","Norwegian King Crab Marine biology","Ocean Quest S.A. de C.V.","OceanFront Delights N.V. Transport","Océano del Este Eel","Odisha Sea  Nori LLC Delivery","Olas del Sur SRL","Pao gan Limited Liability Company","Peterson PLC","Playa de la Luna Carriers Seafarer","Playa de la Luna Starfish","Portuguese Sea Bass & N.V. Logistics","Reese, Phillips and Moody","Reyes-Kelly","Reynolds-King","River Gambia  LLC Transportation","Rogers-Robinson","Romero Ltd and Son's","Rubio-Evans","Ruiz, Sims and Robertson","Ryan-Curry","Saharan Coast  Seafood N.V. United","Sanchez PLC","Sander Ltd. Liability Co Solutions","SeaBass  Leska N.V. International","SeaSelect Foods Salt spray","SeaSolutions Dry dock OJSC Transit","Seashell Seekers ОАО International","SilverScales Ltd. Liability Co","Singleton Ltd","Smith-Best","Spanish Shrimp A/S Marine","Sullivan, Simon and Farmer","Taylor, Choi and Merritt","The Salted Pearl Inc Pelican","The Salted Pearl Kga","Thetis Ltd. Liability Co","Thoho Limited Liability Company","Thompson LLC","Thompson, Shepherd and Phillips","TideTurner Tidepool Co Enterprises","Turkish Calamari LLC Shipping","Turkish Calamari Plc ship","Uttar Pradesh Sea  Ges.m.b.H. Industrial","Uttarakhand   LLC Marine biology","Velazquez-Harris","Vespuci Sandbar Sp Brothers","Walker-Lozano","Watkins Inc","Watkins-Flowers","WaveWorx Abalone N.V. Family","Werner-Ortiz","West Fish  GmbH Transport","Wright LLC","Yu xian  Cargo ship","c(\"Andhra Pradesh  Pic Laksa\", \"Andhra Pradesh  Pic Laksa\")","c(\"Beachcombers Nautical Plc Carriers\", \"Beachcombers Nautical Plc Carriers\", \"SeaSplash Foods Corporation Freight\")","c(\"Costa del Sol Captain Corp Delivery\", \"Costa del Sol Captain Corp Delivery\", \"S.A. de C.V. Sp\")","c(\"Deep Sea Divers BV Logistics\", \"Deep Sea Divers BV Logistics\")","c(\"Dutch Mussels S.p.A. Sea spray\", \"Dutch Mussels S.p.A. Sea spray\")","c(\"French Crab Plc Carriers\", \"French Crab Plc Carriers\")","c(\"Karelians Plc Marine conservation\", \"Karelians Plc Marine conservation\")","c(\"Kerala  Market Oyj Freight\", \"Kerala  Market Oyj Freight\", \"Oka  S.A. de C.V.\")","c(\"Ltd. Corporation Ltd. Corporation\", \"Ltd. Corporation Ltd. Corporation\", \"Ltd. Corporation Ltd. Corporation\", \"Punjab s Pic Express\")","c(\"Maacama  S.p.A. Marine ecology\", \"Maacama  S.p.A. Marine ecology\")","c(\"Mar de Cristal S.A. de C.V.\", \"Brisa del Mar GmbH\")","c(\"Marine Muse Pic Marine ecology\", \"Andhra Pradesh  Limited Liability Company Ray\")","c(\"Marmooska Limited Liability Company\", \"Marmooska Limited Liability Company\")","c(\"Ola de la Costa AS\", \"Ola de la Costa AS\")","c(\"Perla del Mar Ges.m.b.H. Mussel\", \"Perla del Mar Ges.m.b.H. Mussel\")","c(\"Punjab  Market Ltd. Liability Co Brothers\", \"Punjab  Market Ltd. Liability Co Brothers\")","c(\"Sea Striders Kelp BV Solutions\", \"Melanippe GmbH & Co. KG\", \"Melanippe GmbH & Co. KG\")","c(\"SeaSolutions Leska Kga Worldwide\", \"SeaSolutions Leska Kga Worldwide\")","c(\"Yu er he  Sea\", \"Yu er he  Sea\")","hǎi mǎ S.p.A. Transport","hǎi zhé Herring Incorporated Logistics","hǎi zhé S.A. de C.V.","lú yú A/S Shipping","mán yú BV Coral Reef","shā yú NV Transit","Richard Smith","John Smith","David Jones","Michael Carter","Michael Miller","Mark Miller","Michael Bell","Joshua Smith","Michael Smith","Michael Johnson","Jessica Brown","David Thomas","Michael Williams","Robert Johnson","Ashley Harris","Amy Williams","Brian Smith","John Williams","Jennifer Smith","Lisa Johnson","Mary Williams","Christopher Jones","James Smith","Jennifer Taylor","David Johnson"],"country":[null,"ZH","Puerto Sol",null,null,null,null,"Mawazam",null,null,null,"Novarcticaa","ZH",null,"Marebak","Azurionix",null,null,null,"Nalakond",null,"Puerto del Mar",null,null,null,null,null,null,"Riodelsol",null,null,null,null,null,"Zawalinda","Marebak",null,null,null,null,null,null,null,null,"Nalakond",null,null,"Playa Solis",null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Utoporiana",null,"Galduzim",null,null,"Marebak",null,null,"Sol y Oceana",null,"Marebak",null,null,"Marebak","Uziland","Solovarossa","Mawazam","Zawalinda",null,null,null,null,null,null,"Marebak",null,null,"Utoporiana",null,"Marebak","Puerto del Mar","Marebak","Marebak",null,null,null,null,"Marebak","Jiraputra",null,null,null,null,null,null,null,null,null,null,null,"Solovarossa","Isliandor","Marebak",null,null,"Marebak",null,null,"Marebak",null,null,null,null,null,"Utoporiana",null,null,null,"Merigrad","Puerto del Mar",null,null,null,"Nalakond",null,null,null,"Ariuzima",null,"Riodelsol","ZH",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Zawalinda",null,"Marebak","Nalakond","Oceanus",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":[null,"Company","Company",null,null,null,null,"Company",null,null,null,"Company","Company",null,"Company","Company",null,null,null,"Company",null,"Company",null,null,null,null,null,null,"Company",null,null,null,null,null,"Company","Company",null,null,null,null,null,null,null,null,"Company",null,null,"Company",null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Company",null,"Company",null,null,"Company",null,null,"Company",null,"Company",null,null,"Company","Company","Company","Company","Company",null,null,null,null,null,null,"Company",null,null,"Company",null,"Company","Company","Company","Company",null,null,null,null,"Company","Company",null,null,null,null,null,null,null,null,null,null,null,"Company","Company","Company",null,null,"Company",null,null,"Company",null,null,null,null,null,"Company",null,null,null,"Company","Company",null,null,null,"Company",null,null,null,"Company",null,"Company","Company",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Company",null,"Company","Company","Company",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"revenue_omu":[null,9056.2418,8869.44,null,null,null,null,45793.3366,null,null,null,98064.6148,104095830.227,null,null,24730.5026,null,null,null,62860.474,null,null,null,null,null,null,null,null,106160.6949,null,null,null,null,null,33526.7005,11458.9393,null,null,null,null,null,null,null,null,286915.4467,null,null,522907.2209,null,null,null,null,null,null,null,null,null,null,null,null,null,null,82850.9798,null,48723.2683,null,null,12065.2556,null,null,null,null,17621.7291,null,null,13681.2652,30027.3107,79171.2214,74432.6502,57147.6728,null,null,null,null,null,null,54913.4275,null,null,8836217.0955,null,46704.499,null,8923.3586,56029.0094,null,null,null,null,20990.1649,104482.2492,null,null,null,null,null,null,null,null,null,null,null,null,106542.8614,41902.1328,null,null,7299.6543,null,null,707691.602,null,null,null,null,null,430463.8836,null,null,null,26252.1718,null,null,null,null,1052071.6526,null,null,null,null,null,13627.4071,14814.4708,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,33526.7005,null,15734.9367,91387.0965,42166.6728,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"product_services":[null,"A range of fish and other related seafood products","Technical testing and analysis",null,null,null,null,"Food ingredients, frozen fruits and vegetables, ready to eat products, ready to cook products, snacks, drinks and kitchen accessories",null,null,null,"Contract manufacturing services","Fish; fresh or chilled, mackerel (Scomber scombrus, Scomber australasicus, Scomber japonicus), excluding fillets, fish meat of 0304, and edible fish offal of subheadings 0302.91 to 0302.99",null,"Clay refractory, mortar, brick, block, tile, and fabricated clay refractories, such as melting pots; and nonclay refractory, mortar, brick, block, tile, and fabricated nonclay refractories such as graphite, magnesite, silica, or alumina","Fabricated metal products",null,null,null,"Gelatine production processing, with each production step strictly and carefully controlled to meet specifications",null,"Roasted coffee and tea",null,null,null,null,null,null,"Writing tools and materials",null,null,null,null,null,"Consumer goods","Seafood products",null,null,null,null,null,null,null,null,"Sea freight transportation services",null,null,"Smoked salmon products",null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Refractory ceramic products",null,"Poultry meat",null,null,"Meat and processed meat products",null,null,"Chemicals and allied products, such as acids, industrial and heavy chemicals, dyestuffs, industrial salts, rosin, and turpentine",null,"Tuna, sword fish, bass, trout, and salmon, as well as offers shellfish, mollusks, crustaceans, sea vegetables, shrimp, lobster, squid, oysters, crabs, and clams, and other related seafood products",null,null,"Tasselled bookmarks, greeting cards, giftwrappers, doorknob hangers, Kraft paper bags, assorted activity/prayer packs, seed packets, planners and calendars, CD holder, square memo pads & jute strung writing pads, half pads, handmade paper making kit, notebooks, small notebooks, small colored notebooks, journal notebooks, spiral notebooks, posters, colored posters, stickers, theme books, stationery, invitations, gift cards and calling cards, scrapbooks, scrapbook materials & craft cuts","Fluid milk and other related dairy products","Shrimp","Machine tools","Salmon products",null,null,null,null,null,null,"Processing and preserving fish and seafood products",null,null,"Develops innovative products and solutions in chemical and semiconductor sectors",null,"Cooking oil, pure vegetable oil, double-fractionated palm olein, refined palm olein, refined palm oil, pure vegetable ghee, refined corn oil, refined sunflower oil, refined soyabean oil, refined rapeseed oil, pure coconut oil, stearine, palm fatty acid distillate, crude coconut oil, margarine, shortening, and specialty fat","Shipping equipment and fishing tackle","Car and motorcycle anti-theft locks","Automotive parts and accessories",null,null,null,null,"Environment pollution prevention and control special equipment","FOAMGLAS",null,null,null,null,null,null,null,null,null,null,null,"Repair and maintenance of commercial and industrial machinery and equipment","Vertical milling, production bridge milling, high-speed bridge milling, 5-face bridge milling, horizontal milling, and 5-axis milling machines, as well as tapping products and automatic pallet changers","European whole lobster, American lobster, go (with) Huanglong shrimp, spicy shrimp, the Pteris shrimp, raw dragon shrimp, three to go fish, fish fillets, fish maw, caviar, fish, fish The pills, vannamei, shrimp, eel series, and snail series up to dozens of food; Freshwater crayfish, catfish, tilapia and other aquatic products and deep processing",null,null,"Seafood and other aquatic products (frozen and fish prepared seafood products, frozen and fresh prepared shellfish products, frozen fish and shellfish soup, and fresh and frozen surimi)",null,null,"Seafood products",null,null,null,null,null,"Casting and forging technology (sand casting, investment casting, forging), drive technology (gears, winches, direct drive motors, automation), bearing technology (plain bearings, hydrostatic and airostatic bearings), steel profiles, and engineering components",null,null,null,"Miscellaneous durable goods","Frozen sea products",null,null,null,"Windpower equipment and machinery; Related services",null,null,null,"Live and frozen West Coast rock lobster; Live and tailed South Coast lobster",null,"Veneer sheets and wood-based panels","Seafood products",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Salmon in full, half or slices and trims",null,"Fish and sea food products","Frozen products","Men's clothing and accessories",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"topic":[null,"5","4",null,null,null,null,"5",null,null,null,"1","2",null,"4","4",null,null,null,"5",null,"5",null,null,null,null,null,null,"4",null,null,null,null,null,"1","5",null,null,null,null,null,null,null,null,"1",null,null,"2",null,null,null,null,null,null,null,null,null,null,null,null,null,null,"4",null,"5",null,null,"5",null,null,"3",null,"2",null,null,"4","5","2","4","2",null,null,null,null,null,null,"5",null,null,"3",null,"3","4","4","4",null,null,null,null,"4","5",null,null,null,null,null,null,null,null,null,null,null,"4","1","2",null,null,"5",null,null,"5",null,null,null,null,null,"4",null,null,null,"1","2",null,null,null,"1",null,null,null,"2",null,"1","5",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2",null,"5","5","5",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"topic_name":[null,"food products","equipment",null,null,null,null,"food products",null,null,null,"transportation and logistics","fish and other seafood",null,"equipment","equipment",null,null,null,"food products",null,"food products",null,null,null,null,null,null,"equipment",null,null,null,null,null,"transportation and logistics","food products",null,null,null,null,null,null,null,null,"transportation and logistics",null,null,"fish and other seafood",null,null,null,null,null,null,null,null,null,null,null,null,null,null,"equipment",null,"food products",null,null,"food products",null,null,"chemicals and accessories",null,"fish and other seafood",null,null,"equipment","food products","fish and other seafood","equipment","fish and other seafood",null,null,null,null,null,null,"food products",null,null,"chemicals and accessories",null,"chemicals and accessories","equipment","equipment","equipment",null,null,null,null,"equipment","food products",null,null,null,null,null,null,null,null,null,null,null,"equipment","transportation and logistics","fish and other seafood",null,null,"food products",null,null,"food products",null,null,null,null,null,"equipment",null,null,null,"transportation and logistics","fish and other seafood",null,null,null,"transportation and logistics",null,null,null,"fish and other seafood",null,"transportation and logistics","food products",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"fish and other seafood",null,"food products","food products","food products",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"group":[null,"food products","equipment",null,null,null,null,"food products",null,null,null,"transportation and logistics","fish and other seafood",null,"equipment","equipment",null,null,null,"food products",null,"food products",null,null,null,null,null,null,"equipment",null,null,null,null,null,"transportation and logistics","food products",null,null,null,null,null,null,null,null,"transportation and logistics",null,null,"fish and other seafood",null,null,null,null,null,null,null,null,null,null,null,null,null,null,"equipment",null,"food products",null,null,"food products",null,null,"chemicals and accessories",null,"fish and other seafood",null,null,"equipment","food products","fish and other seafood","equipment","fish and other seafood",null,null,null,null,null,null,"food products",null,null,"chemicals and accessories",null,"chemicals and accessories","equipment","equipment","equipment",null,null,null,null,"equipment","food products",null,null,null,null,null,null,null,null,null,null,null,"equipment","transportation and logistics","fish and other seafood",null,null,"food products",null,null,"food products",null,null,null,null,null,"equipment",null,null,null,"transportation and logistics","fish and other seafood",null,null,null,"transportation and logistics",null,null,null,"fish and other seafood",null,"transportation and logistics","food products",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"fish and other seafood",null,"food products","food products","food products",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"value":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,220,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,210,0,0,0,0,0,0,150,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,130,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,42,0,0,0,0,0,28,45,28,50,114,10,10,15,28,55,329,234,28,28,10,57,28,45,234,21,140,15,21,10,10],"shape":[null,"star","star",null,null,null,null,"star",null,null,null,"star","star",null,"star","star",null,null,null,"star",null,"star",null,null,null,null,null,null,"star",null,null,null,null,null,"star","star",null,null,null,null,null,null,null,null,"star",null,null,"star",null,null,null,null,null,null,null,null,null,null,null,null,null,null,"star",null,"star",null,null,"star",null,null,"star",null,"star",null,null,"star","star","star","star","star",null,null,null,null,null,null,"star",null,null,"star",null,"star","star","star","star",null,null,null,null,"star","star",null,null,null,null,null,null,null,null,null,null,null,"star","star","star",null,null,"star",null,null,"star",null,null,null,null,null,"star",null,null,null,"star","star",null,null,null,"star",null,null,null,"star",null,"star","star",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"star",null,"star","star","star",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"x":[0.133178262105169,0.66218522294063,0.439695222201209,0.531563874261693,-0.00876261578269533,-0.072530759809402,-0.91081884206771,-0.0294606043479293,-0.871271900831405,-0.075122490754497,-0.375006884992948,-0.897961836584452,0.238486135491709,-0.446071013661276,-0.416021863459721,-0.469794306178842,-0.184280838392579,0.359965414776612,0.727293968377707,0.358148810474836,0.905477195674655,0.0245023277961476,0.547700081133697,0.133760307371021,0.0636734757130082,0.445102160720847,0.940463833165019,-0.654677116106322,0.302679978656705,-0.478640362303388,0.489528131591467,0.801941573348576,-0.151742587506222,-0.952295160594552,0.796607568422134,0.182612032280876,-0.257182395832292,-0.822715781608307,-0.45906679143334,-0.0409730514522737,0.28532935217412,0.406453545534304,0.346547394024652,-0.529048549640823,-0.00256098192240928,0.310112625844565,0.686302280204903,-0.658604405044626,0.804201641799394,-0.251320741643227,0.423233398490285,-0.562165091276356,-0.644760035204338,0.444214982918848,-0.512299773658369,0.764586710227988,0.863169682871646,-0.882199800906615,0.051134746573068,0.303931522117435,0.74220612918328,0.180558009835124,-0.514588753371655,0.203156715367393,-0.358279346925951,-0.0784999829770642,0.163007930127295,-0.00261131479274124,-0.195960190346766,0.375581459534267,-0.43238261683679,-0.296187873190599,-0.909274392789919,-0.792373947490706,-0.500996807531572,-0.226512732965106,-0.455056643076747,-0.980166281380311,0.144653037960274,-0.367994090142279,-0.276486557792565,-0.0870509448284791,0.390463614098694,0.965513283254116,-1,0.654310129288629,-0.562075764894842,0.186422251060198,0.373729801109398,-0.82346119194082,0.129332606185776,-0.663404161108621,0.944907073620034,0.533605458811003,-0.257199299277519,-0.817869383735247,0.737309375115203,0.638113982168262,0.166961231603908,-0.202528321836775,-0.0524379445854795,-0.48063101949627,6.41710686875019e-05,-0.459919151070512,0.482140084728852,0.516130964304505,-0.380212487740957,-0.609961954997889,-0.326816368385139,0.84292324698352,-0.971466410403372,0.451301543811179,0.387783930777959,0.354616112908789,-0.602643212533607,-0.762051702677945,0.277177257168958,-0.35060985234472,-0.18266256266782,0.851481607111004,0.829348930768018,-0.904306328874257,0.855221983579041,0.805381472516949,0.169461297766045,-0.680808652403342,0.517207614026392,0.31323533719337,-0.258328572845255,-0.0793126470489959,-0.692627201564291,0.0887546123522536,-0.342274580199359,0.274064460191216,0.377303017130918,-0.689869660663208,0.662708023944807,0.780492152889052,0.456785484710867,-0.558626294553735,-0.567906386329441,-0.242243568297113,0.85269566566009,0.512488240011828,-0.834175041692723,0.629669296010596,-0.78168795097386,-0.0375113734391082,-0.293596419696791,0.113064289326704,-0.879230452160124,0.732040043342309,-0.0888240017001714,-0.362248820078967,1,-0.68697382475007,0.583441372175457,-0.811125362062028,0.390498836922583,-0.161913388253469,-0.0689359504805528,-0.736926741535454,0.948210672933384,0.0615205264220613,0.856714044700229,-0.0212458397242664,0.328179664885368,0.719167875526354,-0.647870583596915,0.0336140201296677,0.740060830730554,0.409330391787209,0.0907786383627796,-0.112101113763133,-0.873596042743735,-0.0926166927956722,-0.453054947449983,-0.89548506778979,0.3049131073483,-0.362540099677411,-0.589147808804996,0.46521945589797,0.407246742911951,0.90782517673041,0.0304043167299266,0.849723547944218,-0.780895791802981,-0.371674487471562,-0.292437566439306,-0.555002261443847,-0.588866245408163,0.750015179373204,-0.160834145420751,0.254045723868436],"y":[-0.852063173106422,0.412956228993669,0.0558248501485787,0.180591981023936,-0.178016701485726,0.179762240468749,0.515056789004815,0.993834145166498,0.332151049599842,-0.888127860060262,0.90754657907144,0.135207586340233,0.484540109398164,0.130364313680469,0.74271553609011,0.240221042624058,0.905465241226448,-0.343269093962382,0.595522552974127,-0.674423997322854,0.0894180050860722,-0.0765825836704828,-0.359290749880713,-0.44840981533607,-0.799486541825495,0.663013379354897,-0.223597865235261,-0.397346475446168,0.227495316830565,-0.222541944918766,-0.424666081866249,0.153218025696762,0.997984320644575,0.372658461123192,0.621852327278947,0.535212090532601,-0.630578425942848,-0.0593553579975798,0.564975398080396,0.346559153899429,0.144917048650808,-0.416246793929638,0.0737346894403463,0.764332394149154,-1,-0.829600198405378,0.652521571983354,-0.772045225294417,-0.620882703280365,-0.121348659012649,0.581772832016428,0.838434528934029,0.608307266503712,-0.679835413405431,-0.757057466062866,-0.0469267568969297,-0.251132021309845,-0.29942017044068,-0.568309094712424,-0.737314810478786,-0.443047771265664,0.610516704380925,-0.623850184663623,0.683631129703912,-0.824762564229329,0.55541191685467,0.971369903527143,0.887319191203563,-0.710793455382102,0.936640014090486,-0.286858807542474,-0.868314295695888,-0.0901124334388286,0.425187118493845,-0.147900852952806,-0.812926260975869,-0.0847702101929193,-0.0576488602938616,-0.937686943524433,0.00240007252463936,0.134945464036329,-0.481117339787936,0.508313144379897,0.24585745155507,0.0247248267310287,-0.601461760814111,0.398225138812756,-0.118308599625022,-0.884050023121473,0.53143465829327,-0.539922817178069,0.325818347799623,-0.0713885113241862,-0.202015187666582,-0.208542661262842,0.0941740798677819,-0.12612938716482,0.574729034212508,0.869833755358258,0.523171916313873,-0.39744427251457,0.915020168839557,0.252408404772888,0.472599411328161,0.25226805248765,0.0999705289382742,-0.732361333897843,0.172290994196678,-0.0827255563073743,0.541004095720748,0.102857893214005,-0.189569379400172,0.26952974136356,0.667438433175093,-0.609847169124848,-0.497704599967203,0.719423878029024,0.818429665604332,0.70365482971991,-0.0411827973482385,-0.454415506755214,-0.368679283549515,-0.532240033996648,0.409069343716982,-0.231776578680902,-0.321626519668848,-0.814101807645919,0.487901024484804,0.618253498229936,-0.96728688720948,-0.462466003965456,-0.996435193440302,-0.635509656114855,1,-0.243604696645224,-0.684035201649723,-0.510952382033546,-0.215513273395202,-0.874422460452839,0.620058935341567,-0.819172459724264,0.232872024060714,0.241040740559397,-0.734774320317026,-0.4943627590187,0.487015513783828,0.0124293215419404,-0.556994505824602,-0.280502049985067,-0.0548884930757927,-0.434496617788374,0.38543497838534,0.835824939786882,-0.308926835511279,0.132495860066003,0.232097420408903,-0.279538166848904,-0.279415712258483,0.730289084565633,0.349636062294314,0.660149329399229,-0.262482100998287,-0.147036871342213,-0.318100255296142,0.463342150675822,-0.815081769758548,0.87900828387484,-0.659624695211089,0.519157364524173,-0.906774239888081,0.51105520885376,0.163142872791416,-0.171146613163043,0.269044044475239,0.43508891505355,0.926438184619769,0.83150820796669,0.0199172120834648,0.603367042377793,0.157551203349149,0.274082283240373,-0.304760659793384,-0.779507783811611,0.170719333448324,-0.464962492416108,-0.139427017205472,-0.381778903108258,-0.171158015606392,-0.741352891295221,0.523809134978274,-0.705698207620852,-0.546003710139867,0.610905875900587,0.924017004738479],"label":["Acevedo, Dickson and Gonzalez","Adams Group","Adriatic Catch S.A. de C.V.","Alexander PLC","Alvarez Ltd","Alvarez, Young and Ramos","Andrews, Finley and Mcdaniel","Aqua Aura SE Marine life","Aqua Gourmet Incorporated Creek","Arnold, Wise and Fuentes","Ashley, Christensen and Bender","Bahía del Sol Corporation","Baker and Sons","Bauer-Taylor","Beach Bums Corporation Transit","BlueTide GmbH & Co. KG","Brewer Inc","Brown-Evans","Brown-Frank","Bu yu wang AG","Byrd-Flores","Caracola del Este Sagl Solutions","Carter LLC","Chase, Hernandez and Wade","Chavez PLC","Chen, Jones and Davis","Clayton Ltd","Coleman, Harris and Mitchell","Congo Rapids   AG Sea spray","Cortez Group","Costa de Coral Kga","Davis, Webb and Martin","Dean-Fisher","Dnipro  Saltwater N.V. Services","Faroe Islands  Company World","Faroe Islands  Ltd Express","FinAddict GmbH & Co. KG","Finests  S.A. de C.V.","Fisher Inc","Fowler-Davis","Garcia, Ferguson and Miller","Garcia, Smith and Scott","Gardner, Jones and Armstrong","Graham Inc","Gujarat ers Limited Liability Company","Gutierrez Inc","Guzman-Chang","Gvardeysk Cargo  SRL Investment","Hall-Taylor","Hamilton LLC","Hancock Inc","Haryana Sea  Mudflat Ltd Freight","Haynes and Sons","Henderson and Sons","Hernandez, Smith and Harrison","Hernandez, Stewart and Nelson","Hopkins, Cunningham and Macdonald","Icelandic Shrimp AS Brothers","Isla del Este _","Jackson-Guzman","Jacobs-Henry","Jones, Kennedy and Johnson","Kariba Dam   CJSC Marine sanctuary","Knight-Brown","Kong zhong diao yu  GmbH","Lang, Garcia and Harris","Lee and Sons","Limpopo River  Ltd. Liability Co","Lloyd-Russell","Long-Charles","Luangwa River   Limited Liability Company Holdings","Lucas-Shelton","Madhya Pradesh   Ltd. Liability Co Freight","Malawi Rift   S.A. de C.V. Express","Mar de Coral GmbH and Son's","Mar de Cristal Ltd Abalone","Mar de Cristal ОАО","Mar de Plata Sp","Mar de Sirenas Corporation Transport","Mar del Oeste -","Mcintyre-White","Meadows, Malone and Willis","Miller, Wiggins and Smith","Montes, Kidd and Hall","Moon LLC","Murphy-Russell","Nagaland Sea Catch Ltd. Liability Co Logistics","Nichols PLC","Norwegian Fjord  Corp Cruise ship","Norwegian Fjord  S.A. de C.V. Brothers","Norwegian King Crab Marine biology","Ocean Quest S.A. de C.V.","OceanFront Delights N.V. Transport","Océano del Este Eel","Odisha Sea  Nori LLC Delivery","Olas del Sur SRL","Pao gan Limited Liability Company","Peterson PLC","Playa de la Luna Carriers Seafarer","Playa de la Luna Starfish","Portuguese Sea Bass & N.V. Logistics","Reese, Phillips and Moody","Reyes-Kelly","Reynolds-King","River Gambia  LLC Transportation","Rogers-Robinson","Romero Ltd and Son's","Rubio-Evans","Ruiz, Sims and Robertson","Ryan-Curry","Saharan Coast  Seafood N.V. United","Sanchez PLC","Sander Ltd. Liability Co Solutions","SeaBass  Leska N.V. International","SeaSelect Foods Salt spray","SeaSolutions Dry dock OJSC Transit","Seashell Seekers ОАО International","SilverScales Ltd. Liability Co","Singleton Ltd","Smith-Best","Spanish Shrimp A/S Marine","Sullivan, Simon and Farmer","Taylor, Choi and Merritt","The Salted Pearl Inc Pelican","The Salted Pearl Kga","Thetis Ltd. Liability Co","Thoho Limited Liability Company","Thompson LLC","Thompson, Shepherd and Phillips","TideTurner Tidepool Co Enterprises","Turkish Calamari LLC Shipping","Turkish Calamari Plc ship","Uttar Pradesh Sea  Ges.m.b.H. Industrial","Uttarakhand   LLC Marine biology","Velazquez-Harris","Vespuci Sandbar Sp Brothers","Walker-Lozano","Watkins Inc","Watkins-Flowers","WaveWorx Abalone N.V. Family","Werner-Ortiz","West Fish  GmbH Transport","Wright LLC","Yu xian  Cargo ship","c(\"Andhra Pradesh  Pic Laksa\", \"Andhra Pradesh  Pic Laksa\")","c(\"Beachcombers Nautical Plc Carriers\", \"Beachcombers Nautical Plc Carriers\", \"SeaSplash Foods Corporation Freight\")","c(\"Costa del Sol Captain Corp Delivery\", \"Costa del Sol Captain Corp Delivery\", \"S.A. de C.V. Sp\")","c(\"Deep Sea Divers BV Logistics\", \"Deep Sea Divers BV Logistics\")","c(\"Dutch Mussels S.p.A. Sea spray\", \"Dutch Mussels S.p.A. Sea spray\")","c(\"French Crab Plc Carriers\", \"French Crab Plc Carriers\")","c(\"Karelians Plc Marine conservation\", \"Karelians Plc Marine conservation\")","c(\"Kerala  Market Oyj Freight\", \"Kerala  Market Oyj Freight\", \"Oka  S.A. de C.V.\")","c(\"Ltd. Corporation Ltd. Corporation\", \"Ltd. Corporation Ltd. Corporation\", \"Ltd. Corporation Ltd. Corporation\", \"Punjab s Pic Express\")","c(\"Maacama  S.p.A. Marine ecology\", \"Maacama  S.p.A. Marine ecology\")","c(\"Mar de Cristal S.A. de C.V.\", \"Brisa del Mar GmbH\")","c(\"Marine Muse Pic Marine ecology\", \"Andhra Pradesh  Limited Liability Company Ray\")","c(\"Marmooska Limited Liability Company\", \"Marmooska Limited Liability Company\")","c(\"Ola de la Costa AS\", \"Ola de la Costa AS\")","c(\"Perla del Mar Ges.m.b.H. Mussel\", \"Perla del Mar Ges.m.b.H. Mussel\")","c(\"Punjab  Market Ltd. Liability Co Brothers\", \"Punjab  Market Ltd. Liability Co Brothers\")","c(\"Sea Striders Kelp BV Solutions\", \"Melanippe GmbH & Co. KG\", \"Melanippe GmbH & Co. KG\")","c(\"SeaSolutions Leska Kga Worldwide\", \"SeaSolutions Leska Kga Worldwide\")","c(\"Yu er he  Sea\", \"Yu er he  Sea\")","hǎi mǎ S.p.A. Transport","hǎi zhé Herring Incorporated Logistics","hǎi zhé S.A. de C.V.","lú yú A/S Shipping","mán yú BV Coral Reef","shā yú NV Transit","Richard Smith","John Smith","David Jones","Michael Carter","Michael Miller","Mark Miller","Michael Bell","Joshua Smith","Michael Smith","Michael Johnson","Jessica Brown","David Thomas","Michael Williams","Robert Johnson","Ashley Harris","Amy Williams","Brian Smith","John Williams","Jennifer Smith","Lisa Johnson","Mary Williams","Christopher Jones","James Smith","Jennifer Taylor","David Johnson"]},"edges":{"from":["Acevedo, Dickson and Gonzalez","Adams Group","Adriatic Catch S.A. de C.V.","Alexander PLC","Alvarez Ltd","Alvarez, Young and Ramos","Andrews, Finley and Mcdaniel","Aqua Aura SE Marine life","Aqua Gourmet Incorporated Creek","Arnold, Wise and Fuentes","Ashley, Christensen and Bender","Bahía del Sol Corporation","Baker and Sons","Bauer-Taylor","Beach Bums Corporation Transit","BlueTide GmbH & Co. KG","BlueTide GmbH & Co. KG","Brewer Inc","Brown-Evans","Brown-Frank","Bu yu wang AG","Byrd-Flores","Caracola del Este Sagl Solutions","Carter LLC","Chase, Hernandez and Wade","Chavez PLC","Chen, Jones and Davis","Clayton Ltd","Coleman, Harris and Mitchell","Congo Rapids   AG Sea spray","Cortez Group","Costa de Coral Kga","Davis, Webb and Martin","Dean-Fisher","Dnipro  Saltwater N.V. Services","Faroe Islands  Company World","Faroe Islands  Ltd Express","FinAddict GmbH & Co. KG","Finests  S.A. de C.V.","Fisher Inc","Fowler-Davis","Garcia, Ferguson and Miller","Garcia, Smith and Scott","Gardner, Jones and Armstrong","Graham Inc","Gujarat ers Limited Liability Company","Gutierrez Inc","Guzman-Chang","Gvardeysk Cargo  SRL Investment","Hall-Taylor","Hamilton LLC","Hancock Inc","Haryana Sea  Mudflat Ltd Freight","Haynes and Sons","Henderson and Sons","Hernandez, Smith and Harrison","Hernandez, Stewart and Nelson","Hopkins, Cunningham and Macdonald","Icelandic Shrimp AS Brothers","Isla del Este _","Jackson-Guzman","Jacobs-Henry","Jones, Kennedy and Johnson","Kariba Dam   CJSC Marine sanctuary","Knight-Brown","Kong zhong diao yu  GmbH","Lang, Garcia and Harris","Lee and Sons","Limpopo River  Ltd. Liability Co","Lloyd-Russell","Long-Charles","Luangwa River   Limited Liability Company Holdings","Lucas-Shelton","Madhya Pradesh   Ltd. Liability Co Freight","Malawi Rift   S.A. de C.V. Express","Mar de Coral GmbH and Son's","Mar de Cristal Ltd Abalone","Mar de Cristal ОАО","Mar de Plata Sp","Mar de Sirenas Corporation Transport","Mar del Oeste -","Mar del Oeste -","Mcintyre-White","Meadows, Malone and Willis","Miller, Wiggins and Smith","Montes, Kidd and Hall","Moon LLC","Murphy-Russell","Nagaland Sea Catch Ltd. Liability Co Logistics","Nagaland Sea Catch Ltd. Liability Co Logistics","Nichols PLC","Norwegian Fjord  Corp Cruise ship","Norwegian Fjord  S.A. de C.V. Brothers","Norwegian King Crab Marine biology","Ocean Quest S.A. de C.V.","OceanFront Delights N.V. Transport","Océano del Este Eel","Odisha Sea  Nori LLC Delivery","Olas del Sur SRL","Pao gan Limited Liability Company","Peterson PLC","Playa de la Luna Carriers Seafarer","Playa de la Luna Starfish","Portuguese Sea Bass & N.V. Logistics","Reese, Phillips and Moody","Reyes-Kelly","Reynolds-King","River Gambia  LLC Transportation","Rogers-Robinson","Romero Ltd and Son's","Rubio-Evans","Ruiz, Sims and Robertson","Ryan-Curry","Saharan Coast  Seafood N.V. United","Sanchez PLC","Sander Ltd. Liability Co Solutions","SeaBass  Leska N.V. International","SeaSelect Foods Salt spray","SeaSolutions Dry dock OJSC Transit","Seashell Seekers ОАО International","SilverScales Ltd. Liability Co","Singleton Ltd","Smith-Best","Spanish Shrimp A/S Marine","Sullivan, Simon and Farmer","Taylor, Choi and Merritt","The Salted Pearl Inc Pelican","The Salted Pearl Kga","Thetis Ltd. Liability Co","Thoho Limited Liability Company","Thompson LLC","Thompson, Shepherd and Phillips","TideTurner Tidepool Co Enterprises","Turkish Calamari LLC Shipping","Turkish Calamari Plc ship","Uttar Pradesh Sea  Ges.m.b.H. Industrial","Uttarakhand   LLC Marine biology","Velazquez-Harris","Vespuci Sandbar Sp Brothers","Walker-Lozano","Watkins Inc","Watkins-Flowers","WaveWorx Abalone N.V. Family","Werner-Ortiz","West Fish  GmbH Transport","West Fish  GmbH Transport","Wright LLC","Yu xian  Cargo ship","c(\"Andhra Pradesh  Pic Laksa\", \"Andhra Pradesh  Pic Laksa\")","c(\"Beachcombers Nautical Plc Carriers\", \"Beachcombers Nautical Plc Carriers\", \"SeaSplash Foods Corporation Freight\")","c(\"Costa del Sol Captain Corp Delivery\", \"Costa del Sol Captain Corp Delivery\", \"S.A. de C.V. Sp\")","c(\"Deep Sea Divers BV Logistics\", \"Deep Sea Divers BV Logistics\")","c(\"Dutch Mussels S.p.A. Sea spray\", \"Dutch Mussels S.p.A. Sea spray\")","c(\"French Crab Plc Carriers\", \"French Crab Plc Carriers\")","c(\"Karelians Plc Marine conservation\", \"Karelians Plc Marine conservation\")","c(\"Kerala  Market Oyj Freight\", \"Kerala  Market Oyj Freight\", \"Oka  S.A. de C.V.\")","c(\"Ltd. Corporation Ltd. Corporation\", \"Ltd. Corporation Ltd. Corporation\", \"Ltd. Corporation Ltd. Corporation\", \"Punjab s Pic Express\")","c(\"Maacama  S.p.A. Marine ecology\", \"Maacama  S.p.A. Marine ecology\")","c(\"Mar de Cristal S.A. de C.V.\", \"Brisa del Mar GmbH\")","c(\"Marine Muse Pic Marine ecology\", \"Andhra Pradesh  Limited Liability Company Ray\")","c(\"Marmooska Limited Liability Company\", \"Marmooska Limited Liability Company\")","c(\"Ola de la Costa AS\", \"Ola de la Costa AS\")","c(\"Perla del Mar Ges.m.b.H. Mussel\", \"Perla del Mar Ges.m.b.H. Mussel\")","c(\"Punjab  Market Ltd. Liability Co Brothers\", \"Punjab  Market Ltd. Liability Co Brothers\")","c(\"Sea Striders Kelp BV Solutions\", \"Melanippe GmbH & Co. KG\", \"Melanippe GmbH & Co. KG\")","c(\"SeaSolutions Leska Kga Worldwide\", \"SeaSolutions Leska Kga Worldwide\")","c(\"Yu er he  Sea\", \"Yu er he  Sea\")","hǎi mǎ S.p.A. Transport","hǎi mǎ S.p.A. Transport","hǎi zhé Herring Incorporated Logistics","hǎi zhé S.A. de C.V.","lú yú A/S Shipping","mán yú BV Coral Reef","shā yú NV Transit"],"to":["Richard Smith","John Smith","David Jones","David Jones","Michael Carter","Michael Miller","Mark Miller","Michael Bell","Mark Miller","Richard Smith","Joshua Smith","Michael Smith","Michael Johnson","Jessica Brown","Joshua Smith","David Thomas","Jessica Brown","Michael Bell","Michael Williams","John Smith","Robert Johnson","Ashley Harris","Michael Carter","Michael Williams","Amy Williams","Richard Smith","Michael Johnson","Brian Smith","John Williams","David Jones","Jennifer Smith","Michael Williams","Ashley Harris","Michael Bell","Mark Miller","John Smith","Michael Johnson","Lisa Johnson","Michael Smith","Mary Williams","Michael Miller","David Jones","Michael Williams","David Jones","Joshua Smith","Richard Smith","Robert Johnson","John Smith","Christopher Jones","James Smith","Jennifer Smith","Michael Johnson","Joshua Smith","Mary Williams","Robert Johnson","Christopher Jones","Brian Smith","Brian Smith","John Williams","Amy Williams","Robert Johnson","James Smith","Michael Johnson","Christopher Jones","Michael Johnson","Lisa Johnson","Jennifer Taylor","David Johnson","Michael Bell","Lisa Johnson","David Johnson","Jennifer Smith","Lisa Johnson","Michael Smith","Mark Miller","Jennifer Smith","Lisa Johnson","Jennifer Smith","Michael Smith","Richard Smith","Jennifer Smith","Jessica Brown","Jessica Brown","Amy Williams","Michael Johnson","Ashley Harris","Michael Smith","James Smith","David Thomas","Mary Williams","Michael Carter","Robert Johnson","Mark Miller","Amy Williams","David Thomas","Brian Smith","Michael Williams","Jennifer Smith","Michael Smith","Brian Smith","John Smith","David Johnson","Jennifer Taylor","Amy Williams","Joshua Smith","Michael Miller","Mary Williams","David Jones","David Jones","Lisa Johnson","David Thomas","Jennifer Smith","John Smith","Michael Smith","Michael Williams","David Jones","Michael Johnson","Christopher Jones","John Williams","Michael Johnson","Joshua Smith","Jennifer Taylor","Brian Smith","James Smith","John Williams","James Smith","John Smith","Michael Carter","John Williams","Robert Johnson","Michael Johnson","Jennifer Taylor","Richard Smith","John Williams","Richard Smith","Lisa Johnson","David Johnson","Michael Williams","Christopher Jones","James Smith","Brian Smith","Robert Johnson","Mary Williams","Christopher Jones","Jessica Brown","Michael Miller","Ashley Harris","Robert Johnson","John Williams","John Smith","Michael Smith","Amy Williams","Jennifer Smith","Michael Carter","John Williams","John Smith","Michael Bell","Jennifer Smith","Ashley Harris","David Thomas","Michael Williams","John Williams","Michael Johnson","Michael Miller","Jennifer Taylor","John Williams","Brian Smith","Amy Williams","Michael Carter","John Smith","Richard Smith","David Johnson","James Smith","Mary Williams"],"type":["Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Company Contacts","Beneficial Owner","Beneficial Owner","Company Contacts","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Company Contacts","Company Contacts","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Company Contacts","Company Contacts","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Company Contacts","Beneficial Owner","Company Contacts","Company Contacts","Beneficial Owner","Company Contacts","Beneficial Owner","Beneficial Owner","Beneficial Owner","Company Contacts","Beneficial Owner","Beneficial Owner","Beneficial Owner","Company Contacts","Company Contacts","Company Contacts","Company Contacts","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Company Contacts","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Company Contacts","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Company Contacts","Beneficial Owner","Beneficial Owner","Beneficial Owner","Company Contacts","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Company Contacts","Beneficial Owner","Beneficial Owner","Beneficial Owner","Company Contacts","Beneficial Owner","Company Contacts","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Company Contacts","Company Contacts","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Company Contacts","Company Contacts","Beneficial Owner","Company Contacts","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Company Contacts","Beneficial Owner","Company Contacts","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner"],"weights":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"value":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"groups":{"food products":{"color":"orange"},"fish and other seafood":{"color":"red"},"transportation and logistics":{"color":"lightgreen"},"equipment":{"color":"purple"},"useDefaultGroups":true,"chemicals and accessories":{"color":"yellow"}}},"groups":[null,"food products","equipment","transportation and logistics","fish and other seafood","chemicals and accessories"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"topic_name","main":"Select by topic_name","values":["chemicals and accessories","equipment","fish and other seafood","food products","transportation and logistics"]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"right","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>By applying LDA topic modelling on the product service attribute, I successfully identified the most important business feature for each node and grouped them based on similar business (5 groups). (The nodes with unavailable product_service data are in blue.) From the network, we can observe that usually there are more than one types of business within each small cluster, which is expected because a business chain usually involves more than one type of products/services.</p>
<p>FishEye has determined that companies with anomalous structures are far more likely to be involved in IUU (or other “fishy” business). From the network graphs above, we can clearly observe a big cluster which is suspicious. Each beneficial owner in this cluster owns &gt;=5 companies. This cluster includes several high betweenness nodes as well. Beneficial owner “Jessica Brown” is the essential linkage in this cluster. Therefore her 1-hop neighbouring companies are likely to be involved in IUU fishing too, such as: - BlueTide GmbH &amp; Co.&nbsp;KG - Mar del Oeste - - West Fish GmbH Transport</p>
<p>Besides, there is another company from this cluster named “Nagaland Sea Catch Ltd.&nbsp;Liability Co Logistics” also has high betweenness, as it links two major beneficial owner David Thomas and Mary Williams. This company might also involve in IUU fishing.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>